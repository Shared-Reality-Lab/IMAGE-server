{
    "$schema": "https://json-schema.org/draft/2020-12/schema",
    "$id": "https://bach.cim.mcgill.ca/services/supercollider/tts-description.schema.json",
    "type": "object",
    "title": "SuperCollider TTS",
    "description": "Communication to SuperCollider to assemble TTS segments with non-speech audio.",
    "definitions": {
        "segmentOffset": {
            "description": "Data on the offset of an audio segment in the file and its duration. Both are reported in samples.",
            "type": "object",
            "properties": {
                "offset": {
                    "type": "integer",
                    "minimum": 0
                },
                "duration": {
                    "type": "integer",
                    "minimum": 0
                }
            },
            "required": [ "offset", "duration" ]
        }
    },
    "properties": {
        "audioTemplate": {
            "description": "The locations of the introduction phrase and filler words in the TTS audio.",
            "type": "object",
            "properties": {
                "intro": { "$ref": "#/definitions/segmentOffset" },
                "joining": {
                    "description": "Joining words",
                    "type": "object",
                    "additionalProperties": { "$ref": "#/definitions/segmentOffset" }
                }
            },
            "required": [ "intro" ]
        },
        "ordering": {
            "description": "The type of ordering to use when rendering the description of the scene.",
            "type": {
                "enum": [
                    "leftToRight",
                    "rightToLeft",
                    "bigToSmall",
                    "smallToBig",
                    "topToBottom",
                    "bottomToTop"
                ]
            }
        },
        "objects": {
            "description": "Object list generated by the object detection preprocessor. This should reference the actual schema.",
            "type": "array",
            "items": { 
                "allOf": [
                    { "$ref": "../../preprocessors/object-detection.schema.json#/definitions/object" },
                    {
                        "properties": {
                            "offset": { "$ref": "#/definitions/segmentOffset" }
                        }
                    }
                ]
            }
        },
        "groups": {
            "description": "Groupings composed of a subset of objects detected. This should reference the actual schema.",
            "type": "object"
        },
        "ttsFileName": {
            "description": "The name of the file containing the TTS audio. This will be in the same directory as the file implementing this object.",
            "type": "string"
        },
    },
    "required": [
        "audioTemplate",
        "ordering",
        "objects",
        "ttsFileName",
    ]
}
